# App Store 上架优先级清单（CampusCopy）

更新时间：2026-02-28  
目标：按“先过审、再优化”的顺序推进，尽快进入 TestFlight / App Store 审核。

## P0（必须先完成，否则大概率被拒）

### 1. iOS 发布标识与构建配置补齐
- 风险：缺少标准 iOS 上架配置会直接阻断提交流程。
- 当前现状：`app.json` 仅有 `ios.supportsTablet`，未看到完整发布字段。
- 必做项：
- 配置 iOS `bundleIdentifier`（唯一且稳定）。
- 配置 iOS `buildNumber`（每次提交递增）。
- 补齐 EAS 发布配置（新增 `eas.json`，区分 `dev/preview/production`）。
- 验收标准：
- 能成功打出 iOS production build。
- 可上传 TestFlight 并通过基础处理流程。

### 2. 隐私政策 / 用户协议落地为真实可访问链接
- 风险：登录页只有文案、没有可点击链接，审核容易判定信息不完整。
- 当前现状：登录页显示了 Terms / Privacy Policy 文本，但不是有效跳转。
- 必做项：
- 准备正式网页：Privacy Policy 与 Terms of Service。
- 登录页改为可点击跳转（建议用 `Linking.openURL`）。
- App Store Connect 的隐私政策 URL 与应用内保持一致。
- 验收标准：
- iOS 真机可从登录页打开两份文档。
- 审核账号无需额外说明即可找到完整条款。

### 3. 增加“账号删除”能力（不是只登出）
- 风险：有注册登录但无删号能力，属于高频拒审点。
- 当前现状：已实现 sign out，但未见用户自助删号流程。
- 必做项：
- 在 Profile 增加“删除账号”入口（二次确认 + 风险提示）。
- 后端实现删除流程（Auth + 业务数据清理/匿名化策略）。
- 在隐私政策中写清删除范围与生效时间。
- 验收标准：
- 普通用户可在 App 内完成删号。
- 删号后重新登录失败，关联数据符合预期。

## P1（强烈建议在提审前完成）

### 4. 清理生产包中的 Demo/Mock 入口
- 风险：审核员看到 Demo 账号或大量 mock 回退，会判定功能不完整。
- 当前现状：存在 demo credentials、demo mode、mock fallback。
- 必做项：
- 移除硬编码 demo 账号与默认 demo 登录路径。
- 将 mock fallback 仅保留在开发环境，并在 production 关闭。
- Agent 的 `demo-user` 改为真实登录用户 ID。
- 验收标准：
- 生产构建中无法触发 demo 登录。
- 关键业务路径失败时给出明确错误，不返回伪造成功数据。

### 5. 权限说明与数据披露对齐（相册/定位/生物识别）
- 风险：权限用途说明不足，可能被要求补充说明或直接拒审。
- 当前现状：代码中会请求相册与定位权限。
- 必做项：
- 在 iOS 权限描述中明确每项用途（照片、定位等）。
- 核对 App Store Connect Privacy Nutrition（收集项、用途、是否关联用户）。
- 确保请求权限时机与功能入口一致。
- 验收标准：
- 首次触发权限时文案清晰，审核可复现。
- 隐私披露与实际代码行为一致。

## P2（建议在首发后 1-2 个迭代完成）

### 6. AI Key 安全改造（客户端直连改后端代理）
- 风险：`EXPO_PUBLIC_*` 暴露密钥，存在盗刷与滥用风险。
- 当前现状：客户端直接发请求并携带 Authorization。
- 建议项：
- 改为服务端代理调用 LLM。
- 服务端加速率限制、审计日志与额度保护。
- 客户端仅拿业务 token，不接触供应商 key。

### 7. 测试与发布流水线收敛
- 风险：仓库混入其他子项目测试，CI 信号噪声大。
- 当前现状：`npm test` 会跑到 `openclaw` 子项目导致失败。
- 建议项：
- 只针对 CampusCopy 主应用配置测试范围。
- 增加上架前 smoke checklist（登录、发帖、图片、定位、删除账号）。
- 固化 release checklist（版本号、构建号、隐私链接、审核说明）。

## 推荐执行顺序（7 天冲刺）
1. Day 1-2：完成 P0-1、P0-2（发布配置 + 法务链接）。
2. Day 3：完成 P0-3（删除账号端到端流程）。
3. Day 4-5：完成 P1-4、P1-5（去 demo/mock + 权限/隐私披露对齐）。
4. Day 6：修复提审前缺陷，准备截图与审核说明。
5. Day 7：打 production 包并提 TestFlight / App Store 审核。

## 提审前最终检查（Go/No-Go）
- [ ] 生产包无 demo 账号与 mock 伪成功路径。
- [ ] 登录页可打开 Terms / Privacy Policy 正式链接。
- [ ] App 内可完成账号删除。
- [ ] 权限弹窗文案与实际功能一致。
- [ ] iOS 构建号已递增，TestFlight 上传成功。
- [ ] 审核员测试账号与复现步骤已准备。
